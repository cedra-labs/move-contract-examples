{"version":3,"sources":["../../src/detect.ts"],"sourcesContent":["// Copyright Â© Cedra Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  Wallet,\n  WalletWithFeatures,\n  WalletsEventsListeners,\n  getWallets\n} from '@wallet-standard/core'\n\nimport { MinimallyRequiredFeatures } from './features'\nimport { CedraWallet } from './wallet'\n\n// These features are absolutely required for wallets to function in the Cedra ecosystem.\n// Eventually, as wallets have more consistent support of features, we may want to extend this list.\nconst REQUIRED_FEATURES: (keyof MinimallyRequiredFeatures)[] = [\n  'cedra:account',\n  'cedra:connect',\n  'cedra:disconnect',\n  'cedra:network',\n  'cedra:onAccountChange',\n  'cedra:onNetworkChange',\n  'cedra:signMessage',\n  'cedra:signTransaction'\n]\n\nexport function isWalletWithRequiredFeatureSet<AdditionalFeatures extends Wallet['features']>(\n  wallet: Wallet,\n  additionalFeatures: (keyof AdditionalFeatures)[] = []\n): wallet is WalletWithFeatures<MinimallyRequiredFeatures & AdditionalFeatures> {\n  return [...REQUIRED_FEATURES, ...additionalFeatures].every(\n    (feature) => feature in wallet.features\n  )\n}\n\n/**\n * Helper function to get only Cedra wallets\n * @returns Cedra compatible wallets and `on` event to listen to wallets register event\n */\nexport function getCedraWallets(): {\n  cedraWallets: CedraWallet[]\n  on: <E extends keyof WalletsEventsListeners>(\n    event: E,\n    listener: WalletsEventsListeners[E]\n  ) => () => void\n} {\n  const { get, on } = getWallets()\n\n  const wallets = get()\n\n  const cedraWallets: Wallet[] = []\n\n  wallets.map((wallet: Wallet) => {\n    const isCedra = isWalletWithRequiredFeatureSet(wallet)\n\n    if (isCedra) {\n      cedraWallets.push(wallet)\n    }\n  })\n\n  return { cedraWallets: cedraWallets as CedraWallet[], on }\n}\n"],"mappings":"AAGA,OAIE,cAAAA,MACK,wBAOP,IAAMC,EAAyD,CAC7D,gBACA,gBACA,mBACA,gBACA,wBACA,wBACA,oBACA,uBACF,EAEO,SAASC,EACdC,EACAC,EAAmD,CAAC,EAC0B,CAC9E,MAAO,CAAC,GAAGH,EAAmB,GAAGG,CAAkB,EAAE,MAClDC,GAAYA,KAAWF,EAAO,QACjC,CACF,CAMO,SAASG,GAMd,CACA,GAAM,CAAE,IAAAC,EAAK,GAAAC,CAAG,EAAIR,EAAW,EAEzBS,EAAUF,EAAI,EAEdG,EAAyB,CAAC,EAEhC,OAAAD,EAAQ,IAAKN,GAAmB,CACdD,EAA+BC,CAAM,GAGnDO,EAAa,KAAKP,CAAM,CAE5B,CAAC,EAEM,CAAE,aAAcO,EAA+B,GAAAF,CAAG,CAC3D","names":["getWallets","REQUIRED_FEATURES","isWalletWithRequiredFeatureSet","wallet","additionalFeatures","feature","getCedraWallets","get","on","wallets","cedraWallets"]}